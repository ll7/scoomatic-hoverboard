var staticHeaderlessInfoList={};var externalWindowName="";var preNavigateList={};var fetchWindowSize=false;var doResize={ENABLED_WITH_TARGET:"enabledWithTarget",ENABLED:"enabled",DISABLED:"disabled",doResizeWindow:"disabled",init:function(a){if((a!=null)&&(a!="undefined")){this.doResizeWindow=a}}};var windowDefaultSizeObject={resizeWindowDefaultSize:"",init:function(a){if((a!=null)&&(a!="undefined")){this.resizeWindowDefaultSize=a}}};var staticHeaderlessConfig={disableStaticHeaderless:"true",staticHeaderlessURL:null};staticHeaderlessConfig.init=function(a){staticHeaderlessConfig.disableStaticHeaderless=a.disableStaticHeaderless;staticHeaderlessConfig.staticHeaderlessURL=a.staticHeaderlessURL};function getWindowNameWithPrefix(a){if(a.substr(0,3)!=="WID"){return"WIDx"+a}else{return a}}function getStaticHeaderlessInfo(b){var a=null;if(typeof b!=="undefined"&&b in staticHeaderlessInfoList){a=staticHeaderlessInfoList[b]}return a}function fillStaticHeaderlessInfo(g,d,c){var a={};a.navigationTarget=g;a.winname=d;var f=false;if(c){for(var b=0;b<c.length;b++){var e=ESCAPE_TO_HTML(c[b].name);var h=ESCAPE_TO_HTML(c[b].value);if(e=="private.LaucherUrl"){a.launcherURL=h}else{if(e=="private.RegisterSessionKey"){a.gusid=h}else{if(e=="private.TimeStamp"){a.timeStamp=h}else{if(e=="NavigationTarget"){f=true}}}}}if(typeof(a.launcherURL)!=="undefined"&&!f){c.push({name:"NavigationTarget",value:a.navigationTarget})}if(fetchWindowSize==true){c.push({name:"fetchWindowSize",value:"true"});fetchWindowSize=false}}staticHeaderlessInfoList[getWindowNameWithPrefix(d)]=a}function isStaticHeaderlessEnabled(){return staticHeaderlessConfig.disableStaticHeaderless!="true"}function fillFrmDetailsWithStaticHeaderlessInfo(d,c){var b=false;if(isStaticHeaderlessEnabled()){var a=getStaticHeaderlessInfo(c);if(a!=null&&typeof(a.launcherURL)!=="undefined"){d.action=a.launcherURL;delete staticHeaderlessInfoList[c];b=a}}return b}function isPreNavigateRequestReturned(a){if(typeof a!=="undefined"&&a in preNavigateList){if(preNavigateList[a]===false){return false}delete preNavigateList[a]}return true}function onPreNavigate(e){var c=e.dataObject.winname;if(typeof c==="undefined"||c==""){var b=new Date();c=""+b.getTime();externalWindowName=c}else{if(c=="DefaultExternal"){var b=new Date();c=c+b.getTime();externalWindowName=c}}var d;if(e.dataObject.winfeatures!=""){d=e.dataObject.winfeatures+","}else{d=""}d=prepareWindowAttributesForResize(d);c=handleWindowName(c);preNavigateList[c]=false;var f=document.location.protocol+"//"+document.location.host+frameworkSupport.childHtmlPath;if(isStaticHeaderlessEnabled()&&staticHeaderlessConfig.staticHeaderlessURL!=null){f=staticHeaderlessConfig.staticHeaderlessURL;staticHeaderlessInfoList[c]="preNavigate"}if(externalWindowName!==""){var a=window.open(f,"_blank",d)}else{window.open(f,c,d)}}EPCM.subscribeEvent("urn:com.sapportals:navigation","PreNavigate",onPreNavigate);function getValueByKey(e,c,b){var a=e.split(b);var d=null;for(i=0;i<a.length;i++){if(a[i].substring(0,c.length)==c){d=a[i].substring(c.length+1);break}}return d}function mergeWinFeatures(d,c){var b=getValueByKey(d,"width",",");var a=getValueByKey(d,"height",",");if((b=="null")||(b=="")){d=d.replace("width="+b,"");b=null}if((a=="null")||(a=="")){d=d.replace("height="+a,"");a=null}if(a==null&&b==null){c=enhanceWinFeatures(c);if(d.length>0){d+=c}else{d=c}}return d}function prepareWindowAttributesForResize(b){var a=doResize.doResizeWindow;if((a!=null)&&(a!="undefined")&&(a==doResize.ENABLED||a==doResize.ENABLED_WITH_TARGET)){if((windowDefaultSizeObject!=null)&&(windowDefaultSizeObject.resizeWindowDefaultSize!=null)&&(windowDefaultSizeObject.resizeWindowDefaultSize!="undefined")&&(windowDefaultSizeObject.resizeWindowDefaultSize.length>0)){defaultWinFeature=windowDefaultSizeObject.resizeWindowDefaultSize;b=mergeWinFeatures(b,defaultWinFeature);if(a==doResize.ENABLED_WITH_TARGET){fetchWindowSize=true}}}return b}function handleWindowName(b){if(typeof(b)=="undefined"||b==""||b=="DefaultExternal"||b==""){var a=new Date();b=b+a.getTime()}if(b!="_blank"&&b!="_parent"&&b!="_top"&&b!="_self"){b=encodeURIComponent(b).replace(/%/g,"");b=b.replace(".","");b=b.replace("-","_");b=b.replace(":","");b=getWindowNameWithPrefix(b)}return b}function navigateToHeaderlessWindow(k,c,b,h,j){if(typeof(c)=="undefined"||c==""||c=="DefaultExternal"||c==null){c=externalWindowName;externalWindowName=""}k=prepareWindowAttributesForResize(k);var f=handleWindowName(c);if(isStaticHeaderlessEnabled()){fillStaticHeaderlessInfo(h,c,b)}frameworkSupport.SetNavigationEventObjContainer(j,f);if(f in preNavigateList){preNavigateList[f]=true}else{var a="";var d=getStaticHeaderlessInfo(f);if(isStaticHeaderlessEnabled()&&d!=null&&typeof(d.launcherURL)!=="undefined"){a=staticHeaderlessConfig.staticHeaderlessURL}else{a=document.location.protocol+"//"+document.location.host+frameworkSupport.childHtmlPath}try{k=enhanceWinFeatures(k)}catch(g){}window.open(a+"?winName="+f,"_blank",k)}return}var fillFrmDetails=function(o,d,a){var q;if(isPreNavigateRequestReturned(a)==false){q=false}else{var j=null;var b;var k;var p;var h;if(useNavigationEventObjContainer(a)){j=frameworkSupport.NavigationEventObjContainer[a];nodeIdEventObj=j.dataObject.nodeid;k=j.dataObject.postBody;p=j.dataObject.fullTarget;h=j.dataObject.relativeFlag}else{nodeIdEventObj=nodeid;k=postBody;p=fullTarget;h=relativeFlag}if(k){var e=null;var n=o.innerHTML;var m="<input type=hidden name='UsePost' id='UsePost' value='true'></input>\n";n+=m;for(var f=0;f<k.length;f++){var g=ESCAPE_TO_HTML(k[f].name);var c=ESCAPE_TO_HTML(k[f].value);if(g=="NavigationTarget"){e=c}else{var m="<input type=hidden name='"+g+"' id='"+g+"' value='"+c+"'></input>\n";n+=m}}o.innerHTML=n;if(e!=null){o.NavigationTarget.value=e}EPCM.getSAPTop().postBody=k}var l=fillFrmDetailsWithStaticHeaderlessInfo(o,d);if(l!=false){q=l}else{o.NavigationTarget.value=nodeIdEventObj;if(h&&h=="true"){o.RelativeNavBase.value=nodeIdEventObj;p+="&RelativeNavBase="+encodeURIComponent(nodeIdEventObj)}p=p.replace(/\?windowId=[^&\n]*&/,"?");p=p.replace(/(\?windowId=[^&\n]*)|(&?windowId=[^&\n]*)/,"");if(fetchWindowSize==true){if(p.indexOf("?")!=-1){p+="&fetchWindowSize=true"}else{p+="?fetchWindowSize=true"}fetchWindowSize=false}o.action=p;relativeFlag="false";q=p}if(useNavigationEventObjContainer(a)){delete frameworkSupport.NavigationEventObjContainer[a]}}return q};function useNavigationEventObjContainer(a){if((typeof(frameworkSupport.NavigationEventObjContainer)!=="undefined")&&frameworkSupport.NavigationEventObjContainer!=null&&!JSUtils.isEmpty(a)){return true}else{return false}}function enhanceWinFeatures(d){var c=/width\s*=\s*(\d+)%\s*/;var f=/height\s*=\s*(\d+)%\s*/;var b=d.match(c);var g=d.match(f);if(b){var e=screen.width*parseInt(b[1])/100;d=d.replace(b[0],"width="+e+"px")}if(g){var a=screen.height*parseInt(g[1])/100;d=d.replace(g[0],"height="+a+"px")}return d};